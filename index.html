<!DOCTYPE html>
<html>
<head>
  <title>Mini KSP â€“ Camera Chase</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <style>
    body {
      margin: 0;
      background: black;
      color: lime;
      font-family: monospace;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    canvas {
      background: black;
      border: 1px solid #222;
    }
    button {
      width: 160px;
      height: 70px;
      font-size: 24px;
      background: orange;
      border: none;
      border-radius: 10px;
      margin: 10px;
    }
  </style>
</head>
<body>

<canvas id="game" width="400" height="600"></canvas>
<button id="thrustBtn">ðŸš€ THRUST</button>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
const btn = document.getElementById("thrustBtn");

// ðŸŒ Planet
const planet = {
  x: 0,
  y: 0,
  radius: 80,
  mu: 1200
};

// ðŸš€ Rocket (world space)
let rocket = {
  x: 0,
  y: -planet.radius - 20,
  vx: 0,
  vy: 0,
  angle: -Math.PI / 2,
  fuel: 300,
  thrusting: false
};

// ðŸŽ¥ Camera (starts at rocket)
let camera = {
  x: rocket.x,
  y: rocket.y
};

const thrustPower = 0.05;
const cameraSmoothness = 0.05; // smaller = smoother

// Controls
btn.addEventListener("touchstart", () => rocket.thrusting = true);
btn.addEventListener("touchend", () => rocket.thrusting = false);
btn.addEventListener("mousedown", () => rocket.thrusting = true);
btn.addEventListener("mouseup", () => rocket.thrusting = false);

document.addEventListener("keydown", e => {
  if (e.code === "Space") rocket.thrusting = true;
});
document.addEventListener("keyup", e => {
  if (e.code === "Space") rocket.thrusting = false;
});

// Physics update
function update() {
  // Gravity (inverse square)
  const dx = planet.x - rocket.x;
  const dy = planet.y - rocket.y;
  const r = Math.hypot(dx, dy);

  const g = planet.mu / (r * r);
  rocket.vx += (dx / r) * g;
  rocket.vy += (dy / r) * g;

  // Thrust
  if (rocket.thrusting && rocket.fuel > 0) {
    rocket.vx += Math.cos(rocket.angle) * thrustPower;
    rocket.vy += Math.sin(rocket.angle) * thrustPower;
    rocket.fuel -= 0.3;
  }

  rocket.x += rocket.vx;
  rocket.y += rocket.vy;

  // Crash reset
  if (r < planet.radius) {
    rocket.x = 0;
    rocket.y = -planet.radius - 20;
    rocket.vx = rocket.vy = 0;
  }

  // ðŸŽ¥ CAMERA CHASE (smooth follow)
  camera.x += (rocket.x - camera.x) * cameraSmoothness;
  camera.y += (rocket.y - camera.y) * cameraSmoothness;
}

// Draw
function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  ctx.save();
  ctx.translate(
    canvas.width / 2 - camera.x,
    canvas.height / 2 - camera.y
  );

  // Planet
  ctx.fillStyle = "blue";
  ctx.beginPath();
  ctx.arc(planet.x, planet.y, planet.radius, 0, Math.PI * 2);
  ctx.fill();

  // Rocket
  ctx.save();
  ctx.translate(rocket.x, rocket.y);
  ctx.rotate(rocket.angle);
  ctx.fillStyle = "white";
  ctx.fillRect(-4, -12, 8, 24);

  if (rocket.thrusting && rocket.fuel > 0) {
    ctx.fillStyle = "orange";
    ctx.fillRect(-3, 12, 6, 10);
  }
  ctx.restore();

  ctx.restore();

  // HUD
  ctx.fillStyle = "lime";
  ctx.fillText("Fuel: " + rocket.fuel.toFixed(0), 10, 20);
  ctx.fillText(
    "Speed: " + Math.hypot(rocket.vx, rocket.vy).toFixed(2),
    10,
    40
  );
}

function loop() {
  update();
  draw();
  requestAnimationFrame(loop);
}

loop();
</script>

</body>
</html>
